var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},core;!function(t){var e=function(){function e(){this.dispatchObj=t.ControllerDispatcher.getInstance(),this.eventList={}}return e.prototype.destroy=function(){if(null!=this.eventList){var t=void 0;for(var e in this.eventList){t=this.eventList[e];for(var n=0;n<t.length;n++)this.removeEventListener(e,t[0],t[1],!0)}this.eventList=null}this.dispatchObj=null},e.prototype.addEventListener=function(t,e,n){void 0===n&&(n=null);var i=this.dispatchObj.addEventListener(t,e,n);return i&&(null==this.eventList[t]&&(this.eventList[t]=[]),this.eventList[t].push([e,n])),i},e.prototype.addEventListeners=function(t,e){void 0===e&&(e=null);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var r=0;r<n.length;r++)this.addEventListener(n[r],t,e)},e.prototype.dispatchEvent=function(t){return this.dispatchObj.dispatchEvent(t)},e.prototype.hasEventListener=function(t){return this.dispatchObj.hasEventListener(t)},e.prototype.removeEventListenerAll=function(t,e){void 0===e&&(e=!1);var n=this.eventList[t];if(null!=n){for(var i=0;i<n.length;i++)this.removeEventListener(t,n[0],n[1],e);return delete this.eventList[t],!0}return!1},e.prototype.removeEventListener=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=!1);var r=this.dispatchObj.removeEventListener(t,e,n,i);if(r){var o=this.eventList[t];if(null!=o){for(var s=0;s<o.length;s++)if(o[s][0]==e&&o[s][1]==n){o.splice(s,1);break}0==o.length&&delete this.eventList[t]}}return r},e.prototype.removeEventListeners=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];for(var o=0;o<i.length;o++)this.removeEventListener(i[o],t,e,n)},e}();t.Controller=e,__reflect(e.prototype,"core.Controller",["core.IEventDispatcher","core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function e(){this.dispatchObj=t.ControllerDispatcher.getInstance(),this.dispatchServerObj=t.ServiceDispatcher.getInstance(),this.eventList={},this.activateProtocolCallback=!0}return e.prototype.destroy=function(){if(this.activateProtocolCallback=!1,null!=this.eventList){var t=void 0;for(var e in this.eventList){t=this.eventList[e];for(var n=0;n<t.length;n++)this.removeEventListener(e,t[0],t[1],!0)}this.eventList=null}this.dispatchObj=null,this.dispatchServerObj=null},e.prototype.initModel=function(){},e.prototype.clearData=function(){},e.prototype.getModel=function(e){return t.ModelManage.getInstance().getModel(e)},e.prototype.isActivateProtocolCallback=function(){return this.activateProtocolCallback},e.prototype.setActivateProtocolCallback=function(t){this.activateProtocolCallback=t},e.prototype.addProtocolCallback=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)this.addEventListener(t[n],this.protocolCallback,this)},e.prototype.protocolCallback=function(e){if(this.activateProtocolCallback){var n=this[e.getEventType()];if(null!=n){var i=t.String.getFunctionArgs(n);i.length==e.getParamCount()?n.apply(this,e.getParams()):t.Log.error("协议回调失败，函数定义参数与接收协议参数个数不匹配。数据类: "+t.String.getClassName_Obj(this)+" 中定义的回调函数: "+e.getEventType()+" 参数个数: "+i.length+" 接收协议参数个数: "+e.getParamCount())}else t.Log.error("协议回调失败，数据类: "+t.String.getClassName_Obj(this)+" 中未定义回调函数: "+e.getEventType())}},e.prototype.addEventListener=function(t,e,n){void 0===n&&(n=null);var i=this.dispatchServerObj.addEventListener(t,e,n);return i&&(null==this.eventList[t]&&(this.eventList[t]=[]),this.eventList[t].push([e,n])),i},e.prototype.addEventListeners=function(t,e){void 0===e&&(e=null);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var r=0;r<n.length;r++)this.addEventListener(n[r],t,e)},e.prototype.dispatchEvent=function(t){return this.dispatchObj.dispatchEvent(t)},e.prototype.hasEventListener=function(t){return this.dispatchServerObj.hasEventListener(t)},e.prototype.removeEventListenerAll=function(t,e){void 0===e&&(e=!1);var n=this.eventList[t];if(null!=n){for(var i=0;i<n.length;i++)this.removeEventListener(t,n[0],n[1],e);return this.eventList[t]=null,!0}return!1},e.prototype.removeEventListener=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=!1);var r=this.dispatchServerObj.removeEventListener(t,e,n,i);if(r){var o=this.eventList[t];if(null!=o){for(var s=0;s<o.length;s++)if(o[s][0]==e&&o[s][1]==n){o.splice(s,1);break}0==o.length&&(this.eventList[t]=null)}}return r},e.prototype.removeEventListeners=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];for(var o=0;o<i.length;o++)this.removeEventListener(i[o],t,e,n)},e}();t.Model=e,__reflect(e.prototype,"core.Model",["core.IEventDispatcher","core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.destroy=function(){this.parent=null,this.argList=null,this.viewLayerType=null,e.prototype.destroy.call(this)},n.prototype.open=function(){t.Log.error("所有继承 ViewController 的子类都必须重写 open() 方法，该方法在控制器被添加到显示列表时调用")},n.prototype.close=function(){t.Log.error("所有继承 ViewController 的子类都必须重写 close() 方法，该方法在控制器被移出显示列表时调用")},n.prototype.getParams=function(){return this.argList},n.prototype.setParams=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.argList=t},n.prototype.getParam=function(t){var e=null;return null!=this.argList&&this.argList.length>t&&(e=this.argList[t]),e},n.prototype.getParamCount=function(){return null==this.argList?0:this.argList.length},n.prototype.setParent=function(t,e){this.parent=t,this.viewLayerType=e},n.prototype.getParent=function(){return this.parent},n.prototype.getViewLayerType=function(){return this.viewLayerType},n.prototype.getModel=function(e){return t.ModelManage.getInstance().getModel(e)},n}(t.Controller);t.ViewController=e,__reflect(e.prototype,"core.ViewController")}(core||(core={}));var core;!function(t){var e=function(){function e(){this.eventList={}}return e.prototype.destroy=function(){this.eventList=null},e.prototype.addEventListener=function(e,n,i){void 0===i&&(i=null),null==this.eventList[e]&&(this.eventList[e]=new Array);for(var r,o=this.eventList[e],s=0;s<o.length;s++)if(r=o[s],r.compare(n,i))return t.Log.warning("添加事件监听失败，事件类型："+e+" 中的回调函数添加重复，请检查调用处是否正确调用"),!1;return o.push(new t.Callback(n,i)),!0},e.prototype.addEventListeners=function(t,e){void 0===e&&(e=null);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var r=0;r<n.length;r++)this.addEventListener(n[r],t,e)},e.prototype.dispatchEvent=function(t){if(null==this.eventList[t.getEventType()])return!1;t.setTarget(this);for(var e=this.eventList[t.getEventType()],n=new Array,i=0;i<e.length;i++)n.push(e[i]);t.setTarget(this);for(var i=0;i<n.length;i++)n[i].apply(t);return!0},e.prototype.hasEventListener=function(t){return null!=this.eventList[t]},e.prototype.removeEventListenerAll=function(t,e){if(void 0===e&&(e=!1),null==this.eventList[t])return!1;if(e)for(var n=this.eventList[t],i=n.length-1;i>=0;i--)n[i].destroy();return delete this.eventList[t],!0},e.prototype.removeEventListener=function(t,e,n,i){if(void 0===n&&(n=null),void 0===i&&(i=!1),null==this.eventList[t])return!1;for(var r,o=this.eventList[t],s=0;s<o.length;s++)if(r=o[s],r.compare(e,n))return i&&r.destroy(),o.splice(s,1),0==o.length&&delete this.eventList[t],!0;return!1},e.prototype.removeEventListeners=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];for(var o=0;o<i.length;o++)this.removeEventListener(i[o],t,e,n)},e}();t.EventDispatcher=e,__reflect(e.prototype,"core.EventDispatcher",["core.IEventDispatcher","core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function e(){this._intervalIndex=0,this._cache={},this._loadingCache=new Array,this._intervalIndex=egret.setInterval(this.dealSoundTimer,this,6e4)}return e.prototype.destroy=function(){0!=this._intervalIndex&&(egret.clearInterval(this._intervalIndex),this._intervalIndex=0)},e.prototype.dealSoundTimer=function(){for(var e=egret.getTimer(),n=Object.keys(this._cache),i=0,r=n.length;r>i;i++){var o=n[i];this.checkCanClear(o)&&e-this._cache[o]>=t.SoundManager.CLEAR_TIME&&(delete this._cache[o],RES.destroyRes(o))}},e.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},e.prototype.onResourceLoadComplete=function(t,e){var n=this._loadingCache.indexOf(e);-1!=n&&(this._loadingCache.splice(n,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},e.prototype.loadedPlay=function(t){},e.prototype.checkCanClear=function(t){return!0},e}();t.SoundBase=e,__reflect(e.prototype,"core.SoundBase",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(e){function n(t){void 0===t&&(t=null);var n=e.call(this)||this;return n.percentHeight=100,n.percentWidth=100,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.stageEvents,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.stageEvents,n),null!=t&&n.reloaderSkin(t),n}return __extends(n,e),n.prototype.destroy=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.stageEvents,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.stageEvents,this),this.removeEventListener(eui.UIEvent.COMPLETE,this.loaderSkinCallback,this),this.stage.removeEventListener(egret.Event.RESIZE,this.changeViewFrameSize,this)},n.prototype.stageEvents=function(t){switch(t.type){case egret.Event.ADDED_TO_STAGE:this.stage.addEventListener(egret.Event.RESIZE,this.changeViewFrameSize,this),this.OnEnable();break;case egret.Event.REMOVED_FROM_STAGE:this.stage.removeEventListener(egret.Event.RESIZE,this.changeViewFrameSize,this),this.OnDisable()}},n.prototype.update=function(t){},n.prototype.OnEnable=function(){},n.prototype.OnDisable=function(){},n.prototype.changeWindowSize=function(t,e){},n.prototype.reloaderSkin=function(t){this.addEventListener(eui.UIEvent.COMPLETE,this.loaderSkinCallback,this),this.skinName=t},n.prototype.loaderSkinCallback=function(){this.removeEventListener(eui.UIEvent.COMPLETE,this.loaderSkinCallback,this),this.changeViewFrameSize(),this.loaderSkinComplete()},n.prototype.changeViewFrameSize=function(e){void 0===e&&(e=null);var n=document.documentElement.clientWidth,i=document.documentElement.clientHeight,r=n/i;n=r<t.GameConfig.designSizeAspectRatio?t.GameConfig.designSizeHeight*r:t.GameConfig.designSizeWidth,i=t.GameConfig.designSizeHeight,this.changeWindowSize(n,i)},n.prototype.loaderSkinComplete=function(){},n.prototype.getModel=function(e){return t.ModelManage.getInstance().getModel(e)},n}(eui.Component);t.UIView=e,__reflect(e.prototype,"core.UIView",["core.IBasicObject"])}(core||(core={}));var GameModel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.initModel=function(){},e}(core.Model);__reflect(GameModel.prototype,"GameModel");var core;!function(t){var e=function(){function t(){}return t.convertAll=function(t,e){for(var n=new Array,i=0;i<t.length;i++)n.push(e.apply(t[i]));return n},t.contains=function(t,e){return t.indexOf(e)>=0},t.remove=function(t,e){var n=t.indexOf(e);n>=0&&t.splice(n,1)},t.add=function(t,e){var n=t.indexOf(e);-1==n&&t.push(e)},t.AddRange=function(t,e){for(var n=0;n<e.length;n++)t.push(e[n])},t.Copy=function(t,e,n,i,r){for(var o=0;r>o;o++)n[i+o]=t[e],e++,e>=t.length&&(e=0)},t}();t.ArrayExtend=e,__reflect(e.prototype,"core.ArrayExtend")}(core||(core={}));var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),egret.ImageLoader.crossOrigin="anonymous",egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),core.CoreManage.getInstance().setDisplayObjectContainer(this),core.LoadingManage.getInstance().addConfig("resource/default.res.json","resource/"),core.LoadingManage.getInstance().loadConfig(this.onConfigComplete,this)},e.prototype.onConfigComplete=function(){var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){core.LoadingManage.getInstance().loadGroup("loading",this.onLoadingResLoadComplete,null,this)},e.prototype.onLoadingResLoadComplete=function(){core.PageManage.getInstance().addViewControl(LoadingViewControl,core.ViewLayerType.SceneLayer)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var ProtocolList=function(){function t(){}return t.GetProtocolArgs=function(e){var n=t.protocolList[e];return null==n&&core.Log.error("获取协议参数失败，协议名："+e+"　未在协议列表[ProtocolList.protocolList]中定义"),n},t.protocolList={CheckUser_Jump:["uid","uname","roomid","iconURL"],ReCheckUser_Jump:["uid","uname","roomid","iconURL"],Ready_Jump:[],Move_Jump:["type","drop"],SendPing:[]},t}();__reflect(ProtocolList.prototype,"ProtocolList");var core;!function(t){var e=function(){function e(){}return e.start=function(n){null==e.pointList[n]?e.pointList[n]=t.Time.getUnixTimestamp_msec():t.Log.warning("DottingTimer 开始时间点错误，name: "+n+" 对象已存在，若要添加组打点，请调用 addition() 函数")},e.addition=function(n){if(null!=e.pointList[n]){var i=e.pointList[n];e.pointList[n]=t.Time.getUnixTimestamp_msec(),t.Log.print("DottingTimer_Addition "+n+": "+(e.pointList[n]-i))}else t.Log.warning("DottingTimer 增加时间点错误，name: "+n+" 对象未定义，请先调用 start 函数加入")},e.end=function(n){if(null!=e.pointList[n]){var i=e.pointList[n];e.pointList[n]=null,t.Log.print("DottingTimer_End "+n+": "+(t.Time.getUnixTimestamp_msec()-i))}else t.Log.warning("DottingTimer 结束时间点错误，name: "+n+" 对象不存在")},e.cleanup=function(){e.pointList={}},e.pointList={},e}();t.DottingTimer=e,__reflect(e.prototype,"core.DottingTimer")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.print=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];t.DebugConfig.PrintLog&&(n.splice(0,0,t.Time.getClockTime()+"【"+e.PrintType+"】"),console.log.apply(console,n))},e.warning=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];t.DebugConfig.PrintLog&&(n.splice(0,0,t.Time.getClockTime()+"【"+e.WarningType+"】"),console.log.apply(console,n))},e.error=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(t.DebugConfig.PrintLog)throw new Error(e.analysisLog(e.ErrorType,n))},e.analysisLog=function(e,n){for(var i=t.Time.getClockTime()+"【"+e+"】",r=0;r<n.length;r++)i+=(0==r?" ":", ")+n[r];return i},e.PrintType="Print",e.WarningType="Warning",e.ErrorType="Error",e}();t.Log=e,__reflect(e.prototype,"core.Log")}(core||(core={}));var core;!function(t){var e=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.eventType=t,this.argList=e}return t.prototype.destroy=function(){this.eventType=null,this.argList=null,this.target=null},t.prototype.getEventType=function(){return this.eventType},t.prototype.getTarget=function(){return this.target},t.prototype.setTarget=function(t){this.target=t},t.prototype.getParams=function(){return this.argList},t.prototype.setParams=function(t){this.argList=t},t.prototype.getParam=function(t){var e=null;return this.argList.length>t&&(e=this.argList[t]),e},t.prototype.getParamCount=function(){return this.argList.length},t}();t.Event=e,__reflect(e.prototype,"core.Event",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function e(){return e._create?(t.ModelManage.getInstance().initModels(),void(this.pageManage=t.PageManage.getInstance())):void t.Log.error("CoreManage 单例类，不能通过构造函数实例化。请使用 CoreManage.getInstance() 方法访问该实例")}return e.getInstance=function(){return null==e._instance&&(e._create=!0,e._instance=new e,e._create=!1),e._instance},e.prototype.setDisplayObjectContainer=function(e){var n=t.DisplayManage.getInstance();null!=n.updateFun&&n.updateFun.destroy(),n.updateFun=new t.Action1(this.update,this),null!=n.parent&&n.parent.removeChild(n),e.addChild(n)},e.prototype.update=function(t){null!=this.pageManage&&this.pageManage.update(t)},e.prototype.destroy=function(){this.pageManage.destroy(),this.pageManage=null,t.DisplayManage.getInstance().destroy(),t.ControllerDispatcher.getInstance().destroy(),t.ServiceDispatcher.getInstance().destroy(),t.DottingTimer.cleanup()},e}();t.CoreManage=e,__reflect(e.prototype,"core.CoreManage",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(e){function n(){var i=this;return n._create?i=e.call(this)||this:void t.Log.error("ControllerDispatcher 单例类，不能通过构造函数实例化。请使用 ControllerDispatcher.getInstance() 方法访问该实例")}return __extends(n,e),n.getInstance=function(){return null==n._instance&&(n._create=!0,n._instance=new n,n._create=!1),n._instance},n.prototype.destroy=function(){n._instance=null,e.prototype.destroy.call(this)},n}(t.EventDispatcher);t.ControllerDispatcher=e,__reflect(e.prototype,"core.ControllerDispatcher")}(core||(core={}));var core;!function(t){var e=function(e){function n(){var i=this;return n._create?i=e.call(this)||this:void t.Log.error("ServiceDispatcher 单例类，不能通过构造函数实例化。请使用 ServiceDispatcher.getInstance() 方法访问该实例")}return __extends(n,e),n.getInstance=function(){return null==n._instance&&(n._create=!0,n._instance=new n,n._create=!1),n._instance},n.prototype.destroy=function(){n._instance=null,e.prototype.destroy.call(this)},n}(t.EventDispatcher);t.ServiceDispatcher=e,__reflect(e.prototype,"core.ServiceDispatcher")}(core||(core={}));var core;!function(t){var e=function(){function e(){return this._groupIndex=0,e._create?(this._configs=new Array,this._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),void RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)):void t.Log.error("LoadingManage 单例类，不能通过构造函数实例化。请使用 LoadingManage.getInstance() 方法访问该实例")}return e.getInstance=function(){return null==e._instance&&(e._create=!0,e._instance=new e,e._create=!1),e._instance},e.prototype.destroy=function(){e._instance=null},e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,n,i){this._groups[t]=[e,n,i],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,n,i,r){RES.createGroup(t,e,!0),this.loadGroup(t,n,i,r)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var n="pilferer_"+t;e||(e=[t]),RES.createGroup(n,e,!0),RES.loadGroup(n,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var n=this._groups[e][0],i=this._groups[e][2];null!=n&&n.call(i),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var n=this._groups[e][1],i=this._groups[e][2];null!=n&&n.call(i,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(e){t.Log.warning(e.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(e)},e.prototype.loadResource=function(t,e,n,i,r){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null);var o=t.concat(e),s="loadGroup"+this._groupIndex++;RES.createGroup(s,o,!0),this._groups[s]=[n,i,r],RES.loadGroup(s)},e}();t.LoadingManage=e,__reflect(e.prototype,"core.LoadingManage",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(e){function n(){var i=this;return n._create?(i=e.call(this)||this,i.sceneLayer=new eui.UILayer,i.sceneLayer.touchEnabled=!1,i.addChild(i.sceneLayer),i.windowLayer=new eui.UILayer,i.windowLayer.touchEnabled=!1,i.addChild(i.windowLayer),i.loaderLayer=new eui.UILayer,i.loaderLayer.touchEnabled=!1,i.addChild(i.loaderLayer),i.noticeLayer=new eui.UILayer,i.noticeLayer.touchEnabled=!1,i.addChild(i.noticeLayer),i.addEventListener(egret.Event.ENTER_FRAME,i.enterFrame,i),i.lastRunTime=t.Time.getUnixTimestamp_msec(),i):void t.Log.error("DisplayManage 单例类，不能通过构造函数实例化。请使用 DisplayManage.getInstance() 方法访问该实例")}return __extends(n,e),n.getInstance=function(){return null==n._instance&&(n._create=!0,n._instance=new n,n._create=!1),n._instance},n.prototype.destroy=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),null!=this.updateFun&&(this.updateFun.destroy(),this.updateFun=null),this.sceneLayer&&(this.sceneLayer.parent&&this.sceneLayer.parent.removeChild(this.sceneLayer),this.sceneLayer=null),this.windowLayer&&(this.windowLayer.parent&&this.windowLayer.parent.removeChild(this.windowLayer),this.windowLayer=null),this.loaderLayer&&(this.loaderLayer.parent&&this.loaderLayer.parent.removeChild(this.loaderLayer),this.loaderLayer=null),this.noticeLayer&&(this.noticeLayer.parent&&this.noticeLayer.parent.removeChild(this.noticeLayer),this.noticeLayer=null),this.parent&&this.parent.removeChild(this),n._instance=null},n.prototype.enterFrame=function(e){var n=t.Time.getUnixTimestamp_msec(),i=n-this.lastRunTime;this.lastRunTime=n,null!=this.updateFun&&this.updateFun.apply(i)},n}(eui.UILayer);t.DisplayManage=e,__reflect(e.prototype,"core.DisplayManage")}(core||(core={}));var core;!function(t){var e;!function(t){t[t.Undefined=0]="Undefined",t[t.SceneLayer=1]="SceneLayer",t[t.WindowLayer=2]="WindowLayer",t[t.LoaderLayer=3]="LoaderLayer",t[t.NoticeLayer=4]="NoticeLayer"}(e=t.ViewLayerType||(t.ViewLayerType={}));var n;!function(t){t[t.Undefined=0]="Undefined",t[t.Retain=1]="Retain",t[t.HideBefore=2]="HideBefore",t[t.HideBeforeAll=3]="HideBeforeAll",t[t.RemoveBefore=4]="RemoveBefore",t[t.RemoveBeforeAll=5]="RemoveBeforeAll"}(n=t.RemoveViewType||(t.RemoveViewType={}));var i=function(){function i(){return i._create?(this.controlList={},this.cacheControlList={},void(this.controlUpdateList={})):void t.Log.error("PageManage 单例类，不能通过构造函数实例化。请使用 PageManage.getInstance() 方法访问该实例")}return i.getInstance=function(){return null==i._instance&&(i._create=!0,i._instance=new i,i._create=!1),i._instance},i.prototype.destroy=function(){var t;for(var e in this.controlList){t=this.controlList[e];for(var n=0;n<t.length;n++)t[n].destroy()}t=null,this.controlList=null;for(var e in this.cacheControlList)this.cacheControlList[e].destroy();this.cacheControlList=null,this.controlUpdateList=null,i._instance=null},i.prototype.update=function(t){var e;for(var n in this.controlUpdateList){e=this.controlUpdateList[n];for(var i in e)e[i].update(t)}},i.prototype.addViewControl=function(i,r,o){void 0===o&&(o=n.Retain);for(var s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];var c,l,u=this.getControlList(r),h=t.String.getClassName(i);for(l=0;l<u.length;l++)if(u[l]instanceof i){c=u[l];break}switch(null!=c?(u.splice(l,1),this.removeUpdate(c)):(c=this.cacheControlList[h],null==c?c=new i:this.cacheControlList[h]=null),o){case n.HideBefore:this.removeControlList(u,!1);break;case n.HideBeforeAll:this.removeControlList(u,!1,-1);break;case n.RemoveBefore:this.removeControlList(u,!0);break;case n.RemoveBeforeAll:this.removeControlList(u,!0,-1)}switch(c.setParams.apply(c,s),u.push(c),r){case e.SceneLayer:this.removeControlAll(e.WindowLayer),c.setParent(t.DisplayManage.getInstance().sceneLayer,r);break;case e.WindowLayer:c.setParent(t.DisplayManage.getInstance().windowLayer,r);break;case e.LoaderLayer:c.setParent(t.DisplayManage.getInstance().loaderLayer,r);break;case e.NoticeLayer:c.setParent(t.DisplayManage.getInstance().noticeLayer,r)}return c.open(),this.addUpdate(c),c},i.prototype.getControl=function(t,e){for(var n,i=this.getControlList(e),r=0;r<i.length;r++)if(i[r]instanceof t){n=i[r];break}return n},i.prototype.removeControlAll=function(t,e){void 0===e&&(e=!1),this.removeControlList(this.getControlList(t),e,-1)},i.prototype.removeControl=function(e,n,i){void 0===i&&(i=!1);for(var r,o=this.getControlList(n),s=0;s<o.length;s++)if(r=o[s],o[s]instanceof e){if(o.splice(s,1),this.removeUpdate(r),i)r.destroy();else{var a=t.String.getClassName_Obj(r);null!=this.cacheControlList[a]&&this.cacheControlList[a].destroy(),this.cacheControlList[a]=r,r.close()}break}},i.prototype.removeControlList=function(e,n,i){if(void 0===i&&(i=1),null!=e){i>0&&(i=e.length-i),0>i&&(i=0);for(var r=void 0,o=e.length-1;o>=i;o--)if(r=e[o],e.splice(o,1),this.removeUpdate(r),n)r.destroy();else{var s=t.String.getClassName_Obj(r);null!=this.cacheControlList[s]&&this.cacheControlList[s].destroy(),this.cacheControlList[s]=r,r.close()}}},i.prototype.getControlList=function(n){var i;return n!=e.Undefined?(i=this.controlList[n],null==i&&(i=[],this.controlList[n]=i)):t.Log.error("获取视图列表失败，该视图类型不在识别范围 ViewLayerType: "+n),i},i.prototype.addUpdate=function(e){if(null!=e.update&&"function"==typeof e.update){null==this.controlUpdateList[e.getViewLayerType()]&&(this.controlUpdateList[e.getViewLayerType()]={});var n=t.String.getClassName_Obj(e);this.controlUpdateList[e.getViewLayerType()][n]=e}},i.prototype.removeUpdate=function(e){var n=this.controlUpdateList[e.getViewLayerType()];if(null!=n){var i=t.String.getClassName_Obj(e);null!=n[i]&&delete n[i],t.ObjectExtend.isEmptyObject(n)&&delete this.controlUpdateList[e.getViewLayerType()]}},i}();t.PageManage=i,__reflect(i.prototype,"core.PageManage",["core.IBasicObject"])}(core||(core={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var core;!function(t){var e=function(){function e(){return e._create?(this.modelList={},void this.createModels()):void t.Log.error("ModelManage 单例类，不能通过构造函数实例化。请使用 ModelManage.getInstance() 方法访问该实例")}return e.getInstance=function(){return null==e._instance&&(e._create=!0,e._instance=new e,e._create=!1),e._instance},e.prototype.destroy=function(){for(var t in this.modelList)this.modelList[t].destroy();this.modelList=null,e._instance=null},e.prototype.createModels=function(){for(var e,n,i=ModelList.modelClassList.length,r=0;i>r;r++)e=ModelList.modelClassList[r],n=new e,this.modelList[t.String.getClassName(e)]=n},e.prototype.initModels=function(){for(var t in this.modelList)this.modelList[t].initModel()},e.prototype.clearDataModels=function(){for(var t in this.modelList)this.modelList[t].clearData()},e.prototype.getModel=function(e){var n=t.String.getClassName(e),i=this.modelList[n];return null==i&&t.Log.error("获取数据类 className: "+n+" 失败，该数据类不存在，请确认该类已添加到 ModelList 列表"),i},e}();t.ModelManage=e,__reflect(e.prototype,"core.ModelManage",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function e(){e._create||t.Log.error("HttpRequestManage 单例类，不能通过构造函数实例化。请使用 HttpRequestManage.getInstance() 方法访问该实例"),this.requestList={}}return e.getInstance=function(){return null==e._instance&&(e._create=!0,e._instance=new e,e._create=!1),e._instance},e.prototype.destroy=function(){if(null!=this.requestList){var t;for(var n in this.requestList)t=this.requestList[n],t.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this);this.requestList=null}e._instance=null},e.prototype.send=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=ProtocolList.GetProtocolArgs(e);if(null!=r){r.length!=n.length&&t.Log.error("发送的协议："+e+" 参数与定义参数不匹配，请检查调用处是否错误。定义参数："+r.length+" 传入参数："+n.length);var o={};o.name=e,o.params={};for(var s=0;s<r.length;s++)o.params[r[s]]=n[s];var a=JSON.stringify(o);t.Log.print("发送协议："+a);var c=new egret.HttpRequest;c.responseType=egret.HttpResponseType.TEXT,c.open(t.GameConfig.serverHttpRUL,egret.HttpMethod.POST),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(a),c.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),c.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),c.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),null==this.requestList[c.hashCode]?this.requestList[c.hashCode]=c:t.Log.error("HttpRequest 对象已存在，不能重复添加")}},e.prototype.onGetComplete=function(e){var n=e.currentTarget;n.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),n.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),n.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),this.requestList[n.hashCode]=null,t.Log.print("接收协议："+n.response);var i=JSON.parse(n.response);t.String.isNullOrEmpty(i.name)?t.Log.warning("返回协议失败，协议名未定义"):t.ServiceDispatcher.getInstance().hasEventListener(i.name)?t.ServiceDispatcher.getInstance().dispatchEvent(new t.Event(i.name,i.params)):t.Log.warning("协议："+i.name+" 未定义回调函数，请确认该协议是否有效")},e.prototype.onGetIOError=function(e){var n=e.currentTarget;n.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),n.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),n.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),this.requestList[n.hashCode]=null,t.Log.error("接收协议错误",e)},e.prototype.onGetProgress=function(e){t.Log.print("接收协议进度："+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e}();t.HttpRequestManage=e,__reflect(e.prototype,"core.HttpRequestManage",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.sendNative=function(e,n){switch(void 0===n&&(n=null),null==n&&(n={}),egret.Capabilities.os){case"iOS":case"Android":if("onPKFinish"==e&&(null==window.nativeApp||null==window.nativeApp.onPKFinish)&&null!=window.TZOpen&&null!=window.TZOpen.getResult){var i=JSON.stringify(n);return t.Log.print("发送NativeCall name:"+e+" param:"+i),void window.TZOpen.getResult(i)}if(null!=window.nativeApp&&null!=window.nativeApp[e]){var i=JSON.stringify(n);t.Log.print("发送NativeCall name:"+e+" param:"+i),window.nativeApp[e](i)}break;default:t.Log.warning("发送NativeCall失败，平台未定义",egret.Capabilities.os," name:"+e," param:",JSON.stringify(n))}},e}();t.NativeCall=e,__reflect(e.prototype,"core.NativeCall")}(core||(core={}));var core;!function(t){var e;!function(t){t[t.Empty=0]="Empty",t[t.Connecting=1]="Connecting",t[t.ConnectionSucceed=2]="ConnectionSucceed",t[t.ConnectionFailure=3]="ConnectionFailure",t[t.Disconnect=4]="Disconnect"}(e=t.SocketState||(t.SocketState={}));var n=function(n){function i(){var t=n.call(this)||this;return t._socketState=e.Empty,t}return __extends(i,n),i.prototype.destroy=function(){this.close(),n.prototype.destroy.call(this)},i.prototype.getState=function(){return this._socketState},i.prototype.getDataType=function(){return null==this._socket?null:this._socket.type},i.prototype.connect=function(t,n,i){void 0===i&&(i=egret.WebSocket.TYPE_STRING),null!=this._socket&&this.close(),this._socketState=e.Connecting,i==egret.WebSocket.TYPE_BINARY&&(null!=this._receiveData?this._receiveData.clear():this._receiveData=new egret.ByteArray),this._socket=new egret.WebSocket,this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.socket_ReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.socket_Connect,this),this._socket.addEventListener(egret.Event.CLOSE,this.socket_Close,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.socket_Error,this),this._socket.type=i,this._socket.connect(t,n)
},i.prototype.connectByUrl=function(t,n){void 0===n&&(n=egret.WebSocket.TYPE_STRING),null!=this._socket&&this.close(),this._socketState=e.Connecting,n==egret.WebSocket.TYPE_BINARY&&(null!=this._receiveData?this._receiveData.clear():this._receiveData=new egret.ByteArray),this._socket=new egret.WebSocket,this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.socket_ReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.socket_Connect,this),this._socket.addEventListener(egret.Event.CLOSE,this.socket_Close,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.socket_Error,this),this._socket.type=n,this._socket.connectByUrl(t)},i.prototype.close=function(){null!=this._socket&&(this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.socket_ReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.socket_Connect,this),this._socket.removeEventListener(egret.Event.CLOSE,this.socket_Close,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.socket_Error,this),this._socket.close(),this._socket=null),this._socketState=e.Disconnect,null!=this._receiveData&&this._receiveData.clear()},i.prototype.socket_ReceiveMessage=function(e){this.getDataType()==egret.WebSocket.TYPE_BINARY?(this._socket.readBytes(this._receiveData),this.dispatchEvent(new t.Event(t.SocketEventType.ReceiveData,this.getDataType(),this._receiveData))):this.dispatchEvent(new t.Event(t.SocketEventType.ReceiveData,this.getDataType(),this._socket.readUTF()))},i.prototype.socket_Connect=function(n){this._socketState=e.ConnectionSucceed,this.dispatchEvent(new t.Event(t.SocketEventType.ConnectionSucceed))},i.prototype.socket_Close=function(e){this.close(),this.dispatchEvent(new t.Event(t.SocketEventType.Disconnect))},i.prototype.socket_Error=function(e){this.close(),this.dispatchEvent(new t.Event(t.SocketEventType.ConnectionFailure))},i.prototype.send=function(n){this._socketState==e.ConnectionSucceed?(this._socket.writeUTF(n),this._socket.flush()):t.Log.warning("尚未与服务器建立连接，不可发送协议")},i}(t.EventDispatcher);t.Socket=n,__reflect(n.prototype,"core.Socket")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.ConnectionSucceed="SocketEventType_ConnectionSucceed",t.ConnectionFailure="SocketEventType_ConnectionFailure",t.ReceiveData="SocketEventType_ReceiveData",t.Disconnect="SocketEventType_Disconnect",t}();t.SocketEventType=e,__reflect(e.prototype,"core.SocketEventType")}(core||(core={}));var core;!function(t){var e=function(){function e(){e._create||t.Log.error("SocketManage 单例类，不能通过构造函数实例化。请使用 SocketManage.GetInstance() 方法访问该实例")}return e.getInstance=function(){return null==e._instance&&(e._create=!0,e._instance=new e,e._create=!1),e._instance},e.prototype.destroy=function(){this.closeSocket(),e._instance=null},e.prototype.getState=function(){return null==this._socket?t.SocketState.Empty:this._socket.getState()},e.prototype.createSocket=function(e,n,i){void 0===i&&(i=egret.WebSocket.TYPE_STRING),this.closeSocket(),t.Log.print("创建连接 ip:"+e+" post:"+n),this._socket=new t.Socket,this._socket.addEventListeners(this.socketLongCallback,this,t.SocketEventType.ConnectionSucceed,t.SocketEventType.ConnectionFailure,t.SocketEventType.Disconnect,t.SocketEventType.ReceiveData),this._socket.connect(e,n,i)},e.prototype.createSocketByUrl=function(e,n){void 0===n&&(n=egret.WebSocket.TYPE_STRING),this.closeSocket(),t.Log.print("创建连接 url:"+e),this._socket=new t.Socket,this._socket.addEventListeners(this.socketLongCallback,this,t.SocketEventType.ConnectionSucceed,t.SocketEventType.ConnectionFailure,t.SocketEventType.Disconnect,t.SocketEventType.ReceiveData),this._socket.connectByUrl(e,n)},e.prototype.closeSocket=function(){null!=this._socket&&(this._socket.removeEventListeners(this.socketLongCallback,this,!1,t.SocketEventType.ConnectionSucceed,t.SocketEventType.ConnectionFailure,t.SocketEventType.Disconnect,t.SocketEventType.ReceiveData),this._socket.destroy(),this._socket=null)},e.prototype.send=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(null==this._socket)return void t.Log.warning("socket 未创建，发送协议前请先创建 socket");if(this._socket.getState()!=t.SocketState.ConnectionSucceed)return void t.Log.warning("socket 还未与服务器建立连接，请稍后");var r=ProtocolList.GetProtocolArgs(e);if(null!=r){if(r.length!=n.length)return void t.Log.error("发送的协议："+e+" 参数与定义参数不匹配，请检查调用处是否错误。定义参数："+r.length+" 传入参数："+n.length);var o={};o.name=e,o.params={};for(var s=0;s<r.length;s++)o.params[r[s]]=n[s];var a=JSON.stringify(o);t.Log.print("发送协议："+a),this._socket.send(a)}},e.prototype.socketLongCallback=function(e){switch(e.getEventType()){case t.SocketEventType.ConnectionSucceed:t.Log.print("连接成功"),this.DispatchEventToControl(e);break;case t.SocketEventType.ConnectionFailure:t.Log.print("连接失败"),this.DispatchEventToControl(e);break;case t.SocketEventType.Disconnect:t.Log.print("断开连接"),this.DispatchEventToControl(e);break;case t.SocketEventType.ReceiveData:this.AnalysisProtocol(e.getParam(0),e.getParam(1))}},e.prototype.AnalysisProtocol=function(e,n){var i;if(e==egret.WebSocket.TYPE_STRING){i=n,t.Log.print("接收协议："+i);var r=JSON.parse(i);t.String.isNullOrEmpty(r.name)?t.Log.warning("返回协议失败，协议名未定义"):this.HasEventListener(r.name)?this.DispatchEvent(new t.Event(r.name,r.params)):t.Log.warning("协议："+r.name+" 未定义回调函数，请确认该协议是否有效")}else t.Log.error("返回协议解析数据未定义，二进制数据解析未完善")},e.prototype.DispatchEvent=function(e){return t.ServiceDispatcher.getInstance().dispatchEvent(e)},e.prototype.DispatchEventToControl=function(e){return t.ControllerDispatcher.getInstance().dispatchEvent(e)},e.prototype.HasEventListener=function(e){return t.ServiceDispatcher.getInstance().hasEventListener(e)},e}();t.SocketManage=e,__reflect(e.prototype,"core.SocketManage",["core.IBasicObject"])}(core||(core={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._currBgm="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBgm=""},e.prototype.play=function(t,e){if(this._currBgm!=t){this.stop(),this._currBgm=t,this._loops=e;var n=this.getSound(t);n&&this.playSound(n,this._loops)}},e.prototype.playSound=function(t,e){this._currSound=t,this._currSoundChannel=this._currSound.play(0,e),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBgm==t&&this.playSound(RES.getRes(t),this._loops)},e.prototype.checkCanClear=function(t){return this._currBgm!=t},e}(t.SoundBase);t.SoundBgm=e,__reflect(e.prototype,"core.SoundBgm")}(core||(core={}));var core;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},e.prototype.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(t.SoundBase);t.SoundEffects=e,__reflect(e.prototype,"core.SoundEffects")}(core||(core={}));var core;!function(t){var e=function(){function e(){return e._create?(this.bgmOn=!0,this.effectOn=!0,this.bgmVolume=.5,this.effectVolume=.5,this.bgm=new t.SoundBgm,this.bgm.setVolume(this.bgmVolume),this.effect=new t.SoundEffects,void this.effect.setVolume(this.effectVolume)):void t.Log.error("SoundManager 单例类，不能通过构造函数实例化。请使用 SoundManager.getInstance() 方法访问该实例")}return e.getInstance=function(){return null==e._instance&&(e._create=!0,e._instance=new e,e._create=!1),e._instance},e.prototype.destroy=function(){},e.prototype.playEffect=function(t){this.effectOn&&this.effect.play(t)},e.prototype.playBgm=function(t,e){void 0===e&&(e=0),this.currBgm=t,this.bgmOn&&this.bgm.play(t,e)},e.prototype.stopBgm=function(){this.bgm.stop()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgmOn=function(t){this.bgmOn=t,this.bgmOn?this.currBgm&&this.playBgm(this.currBgm):this.stopBgm()},e.prototype.getBgmOn=function(){return this.bgmOn},e.prototype.getEffectOn=function(){return this.effectOn},e.prototype.setBgmVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgmVolume=t,this.bgm.setVolume(this.bgmVolume)},e.prototype.getBgmVolume=function(){return this.bgmVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}();t.SoundManager=e,__reflect(e.prototype,"core.SoundManager",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function e(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.list=new Array,null!=t&&this.add(t,e)}return e.prototype.destroy=function(){for(var t=0;t<this.list.length;t++)this.list[t].destroy();this.list=null},e.prototype.clean=function(){for(var t=0;t<this.list.length;t++)this.list[t].destroy();this.list=[]},e.prototype.add=function(e,n){for(var i,r=0;r<this.list.length;r++)if(i=this.list[r],i.compare(e,n))return t.Log.warning("Action 添加回调函数失败，该回调还是已添加，无需重复添加"),!1;return this.list.push(new t.Callback(e,n)),!0},e.prototype.remove=function(t,e){for(var n,i=0;i<this.list.length;i++)if(n=this.list[i],n.compare(t,e))return this.list.splice(i,1),!0;return!1},e.prototype.call=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,i,r=0;r<this.list.length;r++)i=this.list[r],n=i.apply.apply(i,t);return n},e}();__reflect(e.prototype,"BasicAction",["core.IBasicObject"]);var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.apply=function(){return this.call()},e}(e);t.Action=n,__reflect(n.prototype,"core.Action");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.apply=function(t){return this.call(t)},e}(e);t.Action1=i,__reflect(i.prototype,"core.Action1");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.apply=function(t,e){return this.call(t,e)},e}(e);t.Action2=r,__reflect(r.prototype,"core.Action2");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.apply=function(t,e,n){return this.call(t,e,n)},e}(e);t.Action3=o,__reflect(o.prototype,"core.Action3");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.apply=function(t,e,n,i){return this.call(t,e,n,i)},e}(e);t.Action4=s,__reflect(s.prototype,"core.Action4");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.apply=function(){return this.call()},e}(e);t.Func=a,__reflect(a.prototype,"core.Func")}(core||(core={}));var ModelList=function(){function t(){}return t.modelClassList=[GameModel],t}();__reflect(ModelList.prototype,"ModelList");var core;!function(t){var e=function(){function t(t,e){this.fun=t,this.obj=e}return t.prototype.destroy=function(){this.fun=null,this.obj=null},t.prototype.apply=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null==this.fun?null:this.fun.apply(this.obj,t)},t.prototype.compare=function(t,e){return this.fun==t&&this.obj==e},t.prototype.getOjb=function(){return this.obj},t.prototype.getFun=function(){return this.fun},t}();t.Callback=e,__reflect(e.prototype,"core.Callback",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function t(){this._keyList=new Array,this._valueList=new Array}return t.prototype.destroy=function(){this.Clear(),this._keyList=null,this._valueList=null},t.prototype.GetKeys=function(){return this._keyList},t.prototype.GetValues=function(){return this._valueList},t.prototype.Clear=function(){this._keyList.splice(0,this._keyList.length),this._valueList.splice(0,this._valueList.length)},Object.defineProperty(t.prototype,"Count",{get:function(){return this._keyList.length},enumerable:!0,configurable:!0}),t.prototype.Add=function(t,e){var n=this._keyList.indexOf(t);-1==n?(this._keyList.push(t),this._valueList.push(e)):this._valueList.splice(n,1,e)},t.prototype.Remove=function(t){var e=this._keyList.indexOf(t);return e>-1?(this._keyList.splice(e,1),this._valueList.splice(e,1),!0):!1},t.prototype.ContainsKey=function(t){var e=this._keyList.indexOf(t);return-1!=e},t.prototype.ContainsValue=function(t){var e=this._valueList.indexOf(t);return-1!=e},t.prototype.GetValue=function(t){var e=this._keyList.indexOf(t);return-1!=e?this._valueList[e]:null},t.prototype.GetKey=function(t){var e=this._valueList.indexOf(t);return-1!=e?this._keyList[e]:null},t}();t.Dictionary=e,__reflect(e.prototype,"core.Dictionary",["core.IBasicObject"])}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.crossMul=function(t,e){return t.x*e.y-t.y*e.x},t.checkCross=function(e,n,i,r){var o=egret.Point.create(e.x-i.x,e.y-i.y),s=egret.Point.create(n.x-i.x,n.y-i.y),a=egret.Point.create(r.x-i.x,r.y-i.y),c=t.crossMul(o,a)*t.crossMul(s,a);return o.x=i.x-e.x,o.y=i.y-e.y,s.x=r.x-e.x,s.y=r.y-e.y,a.x=n.x-e.x,a.y=n.y-e.y,0>=c&&t.crossMul(o,a)*t.crossMul(s,a)<=0?!0:!1},t}();t.MathExtend=e,__reflect(e.prototype,"core.MathExtend")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.isEmptyObject=function(t){if(t)for(var e in t)return!1;return!0},t.getHashCode=function(t){for(var e=t.toString(),n=0,i=e.length,r=2147483648,o=0;i>o;o++)n=31*n+e.charCodeAt(o),n>2147483647&&(n%=r);return n},t}();t.ObjectExtend=e,__reflect(e.prototype,"core.ObjectExtend")}(core||(core={}));var core;!function(t){var e=function(){function t(t){void 0===t&&(t=null),this.value=t}return t}();t.OutValue=e,__reflect(e.prototype,"core.OutValue")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.padLeft=function(t,e,n){return void 0===n&&(n="0"),(Array(e).join(n)+t).slice(-e)},t.padRight=function(t,e,n){return void 0===n&&(n="0"),(t+Array(e).join(n)).substring(0,e)},t.getClassName=function(t){return t.name},t.getClassName_Obj=function(t){return null!=t.__proto__&&null!=t.__proto__.__class__?t.__proto__.__class__:typeof t},t.getFunctionArgs=function(t){var e=t.toString().match(/function\s.*?\(([^)]*)\)/)[1];return e.split(",").map(function(t){return t.replace(/\/\*.*\*\//,"").trim()}).filter(function(t){return t})},t.isNullOrEmpty=function(t){return null==t||""==t},t.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(0==e.length)return null;for(var i=t,r=0;r<e.length;r++){var o=new RegExp("\\{"+r+"\\}","gm");i=i.replace(o,e[r])}return i},t.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);return null!=n?n[2]:null},t.uuid=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(0>=e&&(e=n.length),t>0)for(var r=0;t>r;r++)i[r]=n[0|Math.random()*e];else{var o=void 0;i[8]=i[13]=i[18]=i[23]="-",i[14]="4";for(var r=0;36>r;r++)i[r]||(o=0|16*Math.random(),i[r]=n[19==r?3&o|8:o])}return i.join("")},t.SHA1=function(e){for(var n,i=t.AlignSHA1(e),r=new Array(80),o=1732584193,s=-271733879,a=-1732584194,c=271733878,l=-1009589776,u=0;u<i.length;u+=16){for(var h=o,p=s,d=a,g=c,f=l,v=0;80>v;v++)16>v?r[v]=i[u+v]:r[v]=t.rol(r[v-3]^r[v-8]^r[v-14]^r[v-16],1),n=t.add(t.add(t.rol(o,5),t.ft(v,s,a,c)),t.add(t.add(l,r[v]),t.kt(v))),l=c,c=a,a=t.rol(s,30),s=o,o=n;o=t.add(o,h),s=t.add(s,p),a=t.add(a,d),c=t.add(c,g),l=t.add(l,f)}var y=t.SHA1hex(o)+t.SHA1hex(s)+t.SHA1hex(a)+t.SHA1hex(c)+t.SHA1hex(l);return y.toUpperCase()},t.SHA2=function(e){return t.SHA1(e).toLowerCase()},t.add=function(t,e){return(2147483647&t)+(2147483647&e)^2147483648&t^2147483648&e},t.SHA1hex=function(t){for(var e="0123456789abcdef",n="",i=7;i>=0;i--)n+=e.charAt(t>>4*i&15);return n},t.AlignSHA1=function(t){for(var e=(t.length+8>>6)+1,n=new Array(16*e),i=0;16*e>i;i++)n[i]=0;for(i=0;i<t.length;i++)n[i>>2]|=t.charCodeAt(i)<<24-8*(3&i);return n[i>>2]|=128<<24-8*(3&i),n[16*e-1]=8*t.length,n},t.rol=function(t,e){return t<<e|t>>>32-e},t.ft=function(t,e,n,i){return 20>t?e&n|~e&i:40>t?e^n^i:60>t?e&n|e&i|n&i:e^n^i},t.kt=function(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514},t}();t.String=e,__reflect(e.prototype,"core.String")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.updateFrameCount=function(){e._frameCount++},e.getFrameCount=function(){return e._frameCount},e.updateDeltaTime=function(){if(0==e._deltaTimePoint)e._deltaTimePoint=e.getUnixTimestamp_msec(),e._deltaTime=0;else{var t=e.getUnixTimestamp_msec();e._deltaTime=(t-e._deltaTimePoint)/1e3,e._deltaTimePoint=t}},e.getDeltaTime=function(){return e._deltaTime},e.getProcessTime=function(){return e.getUnixTimestamp_msec()-e.processTime},e.getUnixTimestamp_sec=function(){return Date.now()/1e3},e.getUnixTimestamp_msec=function(){return Date.now()},e.getFullTime=function(){var e=new Date,n=e.getFullYear()+"-"+t.String.padLeft(e.getMonth(),2)+"-"+t.String.padLeft(e.getDay(),2)+" "+t.String.padLeft(e.getHours(),2)+":"+t.String.padLeft(e.getMinutes(),2)+":"+t.String.padLeft(e.getSeconds(),2)+"."+t.String.padLeft(e.getMilliseconds(),3);return n},e.getClockTime=function(){var e=new Date,n=t.String.padLeft(e.getHours(),2)+":"+t.String.padLeft(e.getMinutes(),2)+":"+t.String.padLeft(e.getSeconds(),2)+"."+t.String.padLeft(e.getMilliseconds(),3);return n},e.getServerTime=function(){return-1==e.serverTime&&e.setServerTime(e.getUnixTimestamp_sec()),e.serverTime+(e.getUnixTimestamp_sec()-e.getServerTimeLocalPoint)},e.setServerTime=function(t){e.serverTime=t,e.getServerTimeLocalPoint=e.getUnixTimestamp_sec()},e.timeScale=1,e._frameCount=0,e._deltaTime=0,e._deltaTimePoint=0,e.processTime=e.getUnixTimestamp_msec(),e.serverTime=-1,e}();t.Time=e,__reflect(e.prototype,"core.Time")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.playLoop=function(e,n,i){void 0===n&&(n=!0),void 0===i&&(i=-1);for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];if(0==r.length){for(var s=void 0,a=0;a<e.items.length;a++)s=e.items[a],null==s.tween?null==s.props?s.props={loop:n}:s.props.loop=n:s.tween.loop=n;-1==i?e.play():e.play(i)}else for(var s=void 0,a=0;a<r.length;a++)s=e.items[r[a]],null!=s?(null==s.tween?null==s.props?s.props={loop:n}:s.props.loop=n:s.tween.loop=n,-1==i?e.play():e.play(i)):t.Log.error("播放动画对象失败，该对象索引:"+r[a]+" 超出动画组索引列表")},e}();t.TweenExtend=e,__reflect(e.prototype,"core.TweenExtend")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.PrintLog=!1,t}();t.DebugConfig=e,__reflect(e.prototype,"core.DebugConfig")}(core||(core={}));var core;!function(t){var e;!function(t){t[t.Undefined=0]="Undefined",t[t.View=1]="View",t[t.Color=2]="Color"}(e=t.RichType||(t.RichType={}));var n=function(){function n(){}return n.create=function(t){var e,n=t.match("[a-zA-Z0-9]+");if(n&&n.length>=1)switch(n[0]){case"quad":e=new i;break;case"color":e=new r}return e},n.prototype.destroy=function(){this.clear()},n.prototype.clear=function(){this.richType=e.Undefined,this.index=-1},n.prototype.setInfo=function(t){t=t.slice(1,t.length-1);var e=t.split(" ");if(null!=e)for(var n=void 0,i=void 0,r=void 0,o=void 0,s=0,a=e.length;a>s;s++)r=e[s].match("(\\w+\\s*)=(\\s*[^\\b]+)"),r&&(n=r[1],i=r[2],o=this[n],null!=o&&("string"==typeof o?this[n]=i:"number"==typeof o&&(this[n]=Number(i))))},n.prototype.getRichType=function(){return this.richType},n.prototype.setIndex=function(e){0>e?t.Log.error("富文本对象设置索引错误，索引不能小于0"):this.index=e},n.prototype.getIndex=function(){return this.index},n}();t.RichInfo=n,__reflect(n.prototype,"core.RichInfo",["core.IBasicObject"]);var i=function(t){function n(){var n=t.call(this)||this;return n.name="",n.size=0,n.width=0,n.yoffset=0,n.richType=e.View,n}return __extends(n,t),n.prototype.clear=function(){this.name="",this.size=0,this.width=0,this.yoffset=0,t.prototype.clear.call(this)},n}(n);t.RichInfo_View=i,__reflect(i.prototype,"core.RichInfo_View");var r=function(t){function n(){var n=t.call(this)||this;return n.color="",n.endIndex=0,n.richType=e.Color,n}return __extends(n,t),n.prototype.clear=function(){this.color="",this.endIndex=0,t.prototype.clear.call(this)},n}(n);t.RichInfo_Color=r,__reflect(r.prototype,"core.RichInfo_Color")}(core||(core={}));var core;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._originalContext="",n._context="",n._maxWidth=0,n._bitWide=0,n._bitHeight=0,n.tempDataList=new t.Dictionary,n.t_context=new egret.TextField,n.addChild(n.t_context),n._htmlText=new egret.HtmlTextParser,n.c_sprite=new egret.Sprite,n.addChild(n.c_sprite),n._bitWide=n.t_context.size/4,n._bitHeight=n.t_context.size+n.t_context.lineSpacing,n}return __extends(n,e),n.prototype.destroy=function(){this.t_context&&(this.t_context.parent&&this.t_context.parent.removeChild(this.t_context),this.t_context=null),this.c_sprite&&(this.c_sprite.removeChildren(),this.c_sprite.parent&&this.c_sprite.parent.removeChild(this.c_sprite),this.c_sprite=null),this._richInfoList=null,this._htmlText=null},n.prototype.clear=function(){this.t_context.textFlow=this._htmlText.parser(""),this.c_sprite.removeChildren(),this._richInfoList.splice(0),this._maxWidth=0,this._bitWide=0,this._bitHeight=0},n.prototype.setText=function(t){if(this._originalContext!=t){this._originalContext=t||"";var e=this.analysisRichText(this._originalContext);this._context=e[0],this._richInfoList=e[1],this.updateContent()}},n.prototype.getText=function(){return this._context},n.prototype.getOriginalText=function(){return this._originalContext},n.prototype.setColor=function(e){0>e||e>16777215?t.Log.warning("字体颜色值不在 0 ~ 0xffffff 取值范围"):this.t_context.textColor=e},n.prototype.getColor=function(){return this.t_context.textColor},n.prototype.setFontSize=function(e){1>e?t.Log.warning("字体大小不能小于1"):this.t_context.size!=e&&(this.t_context.size=e,this._bitWide=e/4,this._bitHeight=e+this.t_context.lineSpacing,this.updateContent())},n.prototype.getFontSize=function(){return this.t_context.size},n.prototype.setFont=function(e){t.String.isNullOrEmpty(e)?t.Log.warning("设置字体失败，字体名不能为空"):this.t_context.fontFamily=e},n.prototype.getFont=function(){return this.t_context.fontFamily},n.prototype.setMaxWidth=function(e){0>e?t.Log.warning("设置最大宽度失败，最大宽度不能小于0"):this._maxWidth!=e&&(this._maxWidth=this.width=e,this.updateContent())},n.prototype.getMaxWidth=function(){return this._maxWidth},n.prototype.setLineSpacing=function(t){this.t_context.lineSpacing=t,this._bitHeight=this.getFontSize()+t,this.updateContent()},n.prototype.getLineSpacing=function(){return this.t_context.lineSpacing},n.prototype.analysisRichText=function(e){for(var n,i,r="",o=new Array,s=e,a=s.length,c=s.length,l=0,u=0;;){if(l=s.lastIndexOf("<",a),-1==l){c>=0&&(n=s.slice(0,c),r=n+r);break}if(u=s.indexOf(">",l),-1!=u)if(u++,c>u?(n=s.slice(u,c),r=n+r,c=l):c-=u-l,n=s.slice(l,u),-1!=n.indexOf("</")){var h=n.match("[a-zA-Z0-9]+");null!=h&&h.length>=1&&(this.tempDataList.Add(h[0],s.length-u),s=s.slice(0,l)+s.slice(u,s.length))}else if(i=t.RichInfo.create(n)){switch(i.setInfo(n),i.setIndex(s.length-u),i.getRichType()){case t.RichType.Color:if(this.tempDataList.ContainsKey("color")){var p=this.tempDataList.GetValue("color");this.tempDataList.Remove("color"),i.endIndex=p}}o.splice(0,0,i),s=s.slice(0,l)+s.slice(u,s.length)}a=l-1}for(var d=s.length,g=0,f=o.length;f>g;g++)switch(i=o[g],i.setIndex(d-i.getIndex()),i.getRichType()){case t.RichType.Color:i.endIndex=d-i.endIndex}return[r,o]},n.prototype.updateContent=function(){if(null!=this._richInfoList&&null!=this._context){this.c_sprite.removeChildren();for(var e=new t.OutValue(""),n=new t.OutValue(0),i=new t.OutValue(0),r=new t.OutValue(0),o=void 0,s=void 0,a=0,c=0,l=this._richInfoList.length;l>c;c++)switch(o=this._richInfoList[c],this.calculateNewline(e,this._context.slice(a,o.getIndex())),a=o.getIndex(),o.getRichType()){case t.RichType.View:var u=o;this.calculateInsertImageAndPos(e,t.String.padLeft("",Math.ceil(u.size/this._bitWide),"	"),u.size,n,i,r),s=new eui.Image(u.name+"_png"),s.width=s.height=u.size,s.x=n.value,s.y=i.value,this.c_sprite.addChild(s);break;case t.RichType.Color:var h=o;if(h.getIndex()>=h.endIndex)t.Log.warning("设置文本文字颜色值失败，请检查开始索引和结束索引是否正确");else{a=o.endIndex;var p=this._context.slice(h.getIndex(),a),d=e.value.length;this.calculateNewline(e,p),e.value=e.value.slice(0,d)+"<font color="+h.color+">"+e.value.slice(d,e.value.length)+"</font>"}}a<this._context.length&&this.calculateNewline(e,this._context.slice(a,this._context.length)),this.t_context.textFlow=this._htmlText.parser(e.value)}},n.prototype.calculateNewline=function(t,e){if(this._maxWidth<=0)t.value+=e;else{var n=this.t_context.textFlow;if(this.t_context.textFlow=this._htmlText.parser(t.value+e),this.t_context.width>this._maxWidth)for(var i=0,r=e.length;r>i;i++)this.t_context.textFlow=this._htmlText.parser(t.value+e[0]),this.t_context.width>this._maxWidth&&(t.value+="\n"),t.value+=e[0],e=e.slice(1,e.length);else t.value=t.value+e;this.t_context.textFlow=n}},n.prototype.calculateInsertImageAndPos=function(e,n,i,r,o,s){var a=this.t_context.textFlow;if(this._maxWidth<=0)this.t_context.textFlow=this._htmlText.parser(e.value),r.value=this.t_context.width,e.value+=n;else{if(this.t_context.textFlow=this._htmlText.parser(e.value+n),this.t_context.width>this._maxWidth)e.value+=t.String.padLeft("",Math.ceil(i/this._bitHeight)+1,"\n"),this.t_context.textFlow=this._htmlText.parser(e.value),s.value=this.t_context.numLines,r.value=0,o.value=s.value*this._bitHeight-i;else if(s.value<this.t_context.numLines){var c=e.value.lastIndexOf("\n"),l=e.value.slice(0,c+1)+t.String.padLeft("",Math.ceil(i/this._bitHeight),"\n"),u=e.value.slice(c+1,e.value.length);this.t_context.textFlow=this._htmlText.parser(u),r.value=this.t_context.width,e.value=l+u,this.t_context.textFlow=this._htmlText.parser(e.value),s.value=this.t_context.numLines,o.value=s.value*this._bitHeight-i}else{var c=e.value.lastIndexOf("\n"),u=e.value.slice(c,e.value.length);this.t_context.textFlow=this._htmlText.parser(u),r.value=this.t_context.width,this.t_context.textFlow=this._htmlText.parser(e.value),o.value=s.value*this._bitHeight-i}e.value+=n}this.t_context.textFlow=a},n}(egret.Sprite);t.RichTextField=e,__reflect(e.prototype,"core.RichTextField",["core.IBasicObject"])}(core||(core={}));var CardManager=function(){function t(){this.isReady=!1,this.CardsList=new Array(Config.MaxCardsId)}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t.prototype.update=function(){var t={};HttpManager.getInst().init(),t.userid=Userinfo.getInst().userid,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/getcard",t,this)},t.prototype.getList=function(){return this.CardsList},t.prototype.setList=function(t){this.CardsList=Array(20);for(var e=t.split("|"),n=0,i=e;n<i.length;n++){var r=i[n],o=r.split(":");this.CardsList[o[0]]=o[1]}console.log(this.CardsList)},t.prototype.AddCardList=function(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];this.CardsList[i]++}console.log(this.CardsList)},t.prototype.saveCard=function(){var t="";for(var e in this.CardsList)t+=String(e)+":"+String(this.CardsList[e])+"|";t=t.substr(0,t.length-1);var n={};HttpManager.getInst().init(),n.userid=Userinfo.getInst().userid,n.cardlist=t,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/setcard",n,this)},t.prototype.onPostComplete=function(t){var e=t.currentTarget;console.log("post data : ",e.response);var n=JSON.parse(e.response);"获取成功"==n.Mark&&this.setList(n.card)},t}();__reflect(CardManager.prototype,"CardManager");var CardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/CardSkin.exml",e}return __extends(e,t),e.prototype.init=function(t){this.Card=Cardinfo.getInst().GetCardInfo(t),this.CardIcon.texture=RES.getRes(this.Card.IconUrl),this.Skill.text=this.Card.Skill,this.Name.text=this.Card.Name,this.Cost.text=String(this.Card.Cost),this.Attack.text=String(this.Card.Attack),this.HP.text=String(this.Card.HP),this.CanTouch=!0},e.prototype.BeHurted=function(t){return Number(this.HP.text)>t?(this.HP.text=String(Number(this.HP.text)-t),!0):(this.Dead(),!1)},e.prototype.Dead=function(){this.parent&&this.parent.removeChild(this)},e.prototype.GetAttack=function(){return Number(this.Attack.text)},e.prototype.GetHP=function(){return Number(this.HP.text)},e.prototype.GetRank=function(){return Number(this.Cost.text)},e}(eui.Component);__reflect(CardView.prototype,"CardView");var Config;!function(t){t.MaxHP=30,t.StartHandNum=3,t.MaxHandNum=5,t.TurnAddNum=1,t.MaxDeckNum=20,t.MaxTrunNum=32,t.TurnTime=60,t.everyTurnPower=5,t.CardsNumber=20,t.MaxCardsId=20,t.CardPackCost=100,t.PackCardsNum=5,t.HandBoxWidth=1100,t.HandBoxheight=280,t.HandDistance=25,t.Cardwidth=196,t.Cardheight=280}(Config||(Config={}));var Userinfo=function(){function t(){}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t}();__reflect(Userinfo.prototype,"Userinfo");var Cardinfo=function(){function t(){this.Cards=RES.getRes("CardConfig_json").Cards}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t.prototype.GetCardslength=function(){return this.Cards.length},t.prototype.GetCardInfo=function(t){for(var e=0,n=this.Cards;e<n.length;e++){var i=n[e];if(i.CardId==t)return i}},t}();__reflect(Cardinfo.prototype,"Cardinfo");var DeckManager=function(){function t(){this.isReady=!1,this.DeckCards=[]}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t.prototype.update=function(){var t={};HttpManager.getInst().init(),t.userid=Userinfo.getInst().userid,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/getdeck",t,this)},t.prototype.getDeck=function(){return this.DeckCards},t.prototype.setDeckbyStr=function(t){this.DeckCards=[];for(var e=t.split("|"),n=0,i=e;n<i.length;n++)for(var r=i[n],o=r.split(":"),s=0;s<Number(o[1]);s++)this.DeckCards.push(Number(o[0]));console.log(this.DeckCards)},t.prototype.setDeck=function(t){this.DeckCards=[];for(var e=0;e<t.length;e++)for(var n=0;n<t[e];n++)this.DeckCards.push(e);console.log(this.DeckCards)},t.prototype.saveDeck=function(){for(var t={},e="",n=0,i=this.DeckCards;n<i.length;n++){var r=i[n];null==t[r]?t[r]=1:t[r]++}for(var r in t)e+=String(r)+":"+String(t[r])+"|";e=e.substr(0,e.length-1);var o={};HttpManager.getInst().init(),o.userid=Userinfo.getInst().userid,o.decklist=e,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/setdeck",o,this)},t.prototype.onPostComplete=function(t){var e=t.currentTarget;console.log("post data : ",e.response);var n=JSON.parse(e.response);"获取成功"==n.Mark&&this.setDeckbyStr(n.deck)},t}();__reflect(DeckManager.prototype,"DeckManager");var core;!function(t){var e=function(){function t(){}return t.designSizeWidth=758,t.designSizeHeight=1136,t.designSizeAspectRatio=t.designSizeWidth/t.designSizeHeight,t.serverHttpRUL="ws://120.92.62.28:9021",t.serverIP="120.92.62.28",t.serverPort=9021,t.appkey="NrKzRqUqEdHfEiykWCaEk6f1vsEyCrBM",t}();t.GameConfig=e,__reflect(e.prototype,"core.GameConfig")}(core||(core={}));var ViewList;!function(t){t[t.login=0]="login",t[t.Main=1]="Main",t[t.battle=2]="battle",t[t.shop=3]="shop",t[t.MyDeck=4]="MyDeck"}(ViewList||(ViewList={}));var GameViewControl=function(){function t(){this.NowView=ViewList.login
}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t.prototype.LoadView=function(t){switch(t){case ViewList.login:core.PageManage.getInstance().addViewControl(LoginViewControl,core.ViewLayerType.SceneLayer,core.RemoveViewType.RemoveBefore);break;case ViewList.Main:core.PageManage.getInstance().addViewControl(MainMenuViewControl,core.ViewLayerType.SceneLayer,core.RemoveViewType.RemoveBefore);break;case ViewList.battle:core.PageManage.getInstance().addViewControl(BattleViewControl,core.ViewLayerType.SceneLayer,core.RemoveViewType.RemoveBefore);break;case ViewList.shop:core.PageManage.getInstance().addViewControl(ShopViewControl,core.ViewLayerType.SceneLayer,core.RemoveViewType.RemoveBefore);break;case ViewList.MyDeck:core.PageManage.getInstance().addViewControl(MyDeckViewControl,core.ViewLayerType.SceneLayer,core.RemoveViewType.RemoveBefore)}},t}();__reflect(GameViewControl.prototype,"GameViewControl");var Playerstatus;!function(t){t[t.MyTurn=0]="MyTurn",t[t.Battle=1]="Battle",t[t.EnemyTurn=2]="EnemyTurn",t[t.Stop=3]="Stop",t[t.End=4]="End"}(Playerstatus||(Playerstatus={}));var BattleView=function(t){function e(){var e=t.call(this,"resource/skins/BattleSkin.exml")||this;return e.MyBattleCard=new Array(3),e.EnemyBattleCard=new Array(3),e.HandCard=new Array,e.MyBlocks=new Array,e}return __extends(e,t),e.prototype.open=function(){var t=this;for(this.addAllListener(),this.init(),core.SoundManager.getInstance().playBgm("BGM_Battle_m4a"),this.Mystatus=Playerstatus.Stop,this.MyDeck=DeckManager.getInst().getDeck().slice(0),this.Timer=new egret.Timer(1e3,60),this.Timer.addEventListener(egret.TimerEvent.TIMER,function(){t.MyTime.text=String(Number(t.MyTime.text)-1),t.EnemyTime.text=String(Number(t.EnemyTime.text)-1)},this),this.Timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){t.Mystatus==Playerstatus.MyTurn&&t.MyBattleTurn()},this);this.HandCard.length<Config.StartHandNum;)this.DrawCard()},e.prototype.destroy=function(){},e.prototype.addAllListener=function(){var t=this;this.ExitTurnGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.Mystatus==Playerstatus.MyTurn&&t.MyBattleTurn()},this)},e.prototype.init=function(){this.MyBlocks.push(this.My_block_1),this.MyBlocks.push(this.My_block_2),this.MyBlocks.push(this.My_block_3),this.MyHP.text=String(Config.MaxHP),this.MyHandNum.text="0",this.MyCardNum.text=String(Config.MaxDeckNum),this.EnemyHP.text=String(Config.MaxHP),this.EnemyHandNum.text=String(Config.StartHandNum),this.EnemyCardNum.text=String(Config.MaxDeckNum-Config.StartHandNum)},e.prototype.addHandListener=function(t){var e=this;t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.ChangeShowCard(t.Card.CardId),e.GameGroup.removeChild(t),e.GameGroup.addChild(t)},this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(n){t.CanTouch&&e.Mystatus==Playerstatus.MyTurn&&(t.x=n.stageX-t.width/2,t.y=n.stageY-t.height/2)},this),t.addEventListener(egret.TouchEvent.TOUCH_END,function(n){if(0!=t.CanTouch&&e.Mystatus==Playerstatus.MyTurn){for(var i=0;i<e.MyBlocks.length;i++)if(e.MyBlocks[i].hitTestPoint(n.stageX,n.stageY)&&null==e.MyBattleCard[i]){if(0==e.UsePower("Me",t.Card.Cost)){e.TishiGroup.visible=!0,e.Tishi.text="能量不足",e.Mystatus=Playerstatus.Stop,egret.setTimeout(function(){e.TishiGroup.visible=!1,e.Mystatus=Playerstatus.MyTurn},e,1e3);break}core.SoundManager.getInstance().playEffect(t.Card.Sound),t.CanTouch=!1;var r=e.MyBattleBox.localToGlobal(e.MyBlocks[i].x,e.MyBlocks[i].y);t.x=r.x,t.y=r.y,e.MyBattleCard[i]=t,e.HandCard.splice(e.HandCard.indexOf(t),1),e.MyHandNum.text=String(Number(e.MyHandNum.text)-1);var o={};o.Block_num=i,o.CardId=t.Card.CardId,ALISDK.CatcherSDK.instance().sendJson({"function":"summonCard",params:o})}e.UpdateHandCard()}},this)},e.prototype.StartGame=function(t){var e=this;"Me"==t?(this.TishiGroup.visible=!0,this.Tishi.text="您是先手",this.MyTimeGroup.visible=!0,this.EnemyTimeGroup.visible=!1,egret.setTimeout(function(){e.TishiGroup.visible=!1,e.Mystatus=Playerstatus.MyTurn,e.AddPower("Me"),e.DrawCard(),e.Timer.start()},this,3e3)):(this.TishiGroup.visible=!0,this.Tishi.text="您是后手",this.MyTimeGroup.visible=!1,this.EnemyTimeGroup.visible=!0,this.ExitTurnGroup.visible=!1,egret.setTimeout(function(){e.TishiGroup.visible=!1,e.Mystatus=Playerstatus.EnemyTurn,e.AddPower("Enemy"),e.EnemyCardNum.text=String(Number(e.MyCardNum.text)-1),e.EnemyHandNum.text=String(Config.StartHandNum+1),e.Timer.start()},this,3e3))},e.prototype.UpdateHandCard=function(){for(var t=this.HandCardBox.x,e=this.HandCardBox.y,n=0;n<this.HandCard.length;n++)this.HandCard[n].x=t,this.HandCard[n].y=e,t+=Config.Cardwidth+Config.HandDistance},e.prototype.DrawCard=function(){if(this.HandCard.length<5){var t=new CardView;this.GameGroup.addChild(t),this.addHandListener(t);var e=Math.floor(Math.random()*this.MyDeck.length);t.init(this.MyDeck[e]),this.MyDeck.splice(e,1),this.HandCard.push(t),this.UpdateHandCard(),this.MyCardNum.text=String(Number(this.MyCardNum.text)-1),this.MyHandNum.text=String(this.HandCard.length)}},e.prototype.AttackTween=function(t,e){var n=this,i=new eui.Component;i.skinName="resource/skins/AttackSkin.exml",t.y<e.y?(i.rotation=180,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2):(i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2),this.GameGroup.addChild(i),i.x=t.x,i.y=t.y,i.width=256,i.height=80,egret.Tween.get(i).to({x:e.x,y:e.y},300).call(function(){n.GameGroup.removeChild(i)},this)},e.prototype.addStandListener=function(t){var e=this;t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.ChangeShowCard(t.Card.CardId)},this)},e.prototype.ChangeShowCard=function(t){this.ShowCard.visible=!0,this.ShowCard.init(t)},e.prototype.HurtPlayer=function(t,e){if("Me"==t&&Number(this.MyHP.text)>e)this.MyHP.text=String(Number(this.MyHP.text)-e);else if("Enemy"==t&&Number(this.EnemyHP.text)>e)this.EnemyHP.text=String(Number(this.EnemyHP.text)-e);else if("Me"==t&&Number(this.MyHP.text)<=e)this.MyHP.text="0";else if("Enemy"==t&&Number(this.EnemyHP.text)<=e){this.EnemyHP.text="0";var n={};ALISDK.CatcherSDK.instance().sendJson({"function":"gameover",params:n})}},e.prototype.MyBattleTurn=function(){var t=this;this.Mystatus=Playerstatus.Battle;for(var e,n,i,r=function(r){null!=o.MyBattleCard[r]&&(e=o.EnemyBattleBox.localToGlobal(o.Enemy_block_1.x,o.Enemy_block_1.y),n=new egret.Point(o.MyBattleCard[r].x+o.MyBattleCard[r].width/2,o.MyBattleCard[r].y+o.MyBattleCard[r].height/2),i=new egret.Point(e.x+o.Enemy_block_1.width/2+242*r,e.y+o.Enemy_block_1.height/2),o.AttackTween(n,i),egret.setTimeout(function(){if(null!=t.EnemyBattleCard[r]){var e=t.EnemyBattleCard[r].BeHurted(t.MyBattleCard[r].GetAttack());0==e&&(t.EnemyBattleCard[r]=null)}else t.HurtPlayer("Enemy",t.MyBattleCard[r].GetAttack())},o,300))},o=this,s=0;3>s;s++)r(s);egret.setTimeout(function(){t.Mystatus!=Playerstatus.End&&(t.Mystatus=Playerstatus.Stop,t.EnemyTurn())},this,500);var a={};ALISDK.CatcherSDK.instance().sendJson({"function":"NextTurn",params:a})},e.prototype.EnemyTurn=function(){var t=this;if(this.Mystatus!=Playerstatus.End){if(this.MyTimeGroup.visible=!1,this.EnemyTimeGroup.visible=!0,this.ExitTurnGroup.visible=!1,this.Timer.reset(),this.AddPower("Enemy"),!(Number(this.EnemyCardNum.text)>0)){var e={};return void ALISDK.CatcherSDK.instance().sendJson({"function":"gameover",params:e})}this.EnemyCardNum.text=String(Number(this.EnemyCardNum.text)-1),Number(this.EnemyHandNum.text)<5&&(this.EnemyHandNum.text=String(Number(this.EnemyHandNum.text)+1)),this.TishiGroup.visible=!0,this.Tishi.text="对手回合",this.MyTimeGroup.visible=!1,this.EnemyTimeGroup.visible=!0,egret.setTimeout(function(){t.Mystatus!=Playerstatus.End&&(t.TishiGroup.visible=!1,t.Mystatus=Playerstatus.EnemyTurn,t.Timer.reset(),t.MyTime.text=String(Config.TurnTime),t.EnemyTime.text=String(Config.TurnTime),t.Timer.start())},this,3e3)}},e.prototype.EnemyNextTurn=function(){var t=this;this.Mystatus=Playerstatus.Battle,this.EnemyBattleTurn(),egret.setTimeout(function(){t.Mystatus!=Playerstatus.End&&t.MyTurn()},this,500)},e.prototype.MyTurn=function(){var t=this;this.TishiGroup.visible=!0,this.Tishi.text="您的回合",this.MyTimeGroup.visible=!0,this.EnemyTimeGroup.visible=!1,this.ExitTurnGroup.visible=!0,egret.setTimeout(function(){t.TishiGroup.visible=!1,t.Mystatus=Playerstatus.MyTurn,t.AddPower("Me"),t.DrawCard(),t.Timer.reset(),t.MyTime.text=String(Config.TurnTime),t.EnemyTime.text=String(Config.TurnTime),t.Timer.start()},this,3e3)},e.prototype.EnemyBattleTurn=function(){for(var t,e,n,i=this,r=function(r){null!=o.EnemyBattleCard[r]&&(t=o.MyBattleBox.localToGlobal(o.My_block_1.x,o.My_block_1.y),e=new egret.Point(o.EnemyBattleCard[r].x+o.EnemyBattleCard[r].width/2,o.EnemyBattleCard[r].y+o.EnemyBattleCard[r].height/2),n=new egret.Point(t.x+o.My_block_1.width/2+242*r,t.y+o.My_block_1.height/2),o.AttackTween(e,n),egret.setTimeout(function(){if(null!=i.MyBattleCard[r]){var t=i.MyBattleCard[r].BeHurted(i.EnemyBattleCard[r].GetAttack());0==t&&(i.MyBattleCard[r]=null)}else i.HurtPlayer("Me",i.EnemyBattleCard[r].GetAttack())},o,300))},o=this,s=0;3>s;s++)r(s)},e.prototype.Enemysummon=function(t,e){if(this.Mystatus!=Playerstatus.End){if(0==this.UsePower("Enemy",Cardinfo.getInst().GetCardInfo(e).Cost))return void console.error("对手法力值无法召唤");var n=new CardView;if(this.GameGroup.addChild(n),n.init(e),this.EnemyHandNum.text=String(Number(this.EnemyHandNum.text)-1),0==t){n.CanTouch=!1;var i=this.EnemyBattleBox.localToGlobal(this.Enemy_block_1.x,this.Enemy_block_1.y);n.x=i.x,n.y=i.y,this.EnemyBattleCard[0]=n}else if(1==t){n.CanTouch=!1;var i=this.EnemyBattleBox.localToGlobal(this.Enemy_block_2.x,this.Enemy_block_2.y);n.x=i.x,n.y=i.y,this.EnemyBattleCard[1]=n}else if(2==t){n.CanTouch=!1;var i=this.EnemyBattleBox.localToGlobal(this.Enemy_block_3.x,this.Enemy_block_3.y);n.x=i.x,n.y=i.y,this.EnemyBattleCard[2]=n}}},e.prototype.Result=function(t){this.Mystatus!=Playerstatus.End&&(this.Timer.stop(),this.MyTimeGroup.visible=!1,this.EnemyTimeGroup.visible=!1,this.Mystatus=Playerstatus.End,this.TishiGroup.visible=!0,"Me"==t?(this.Tishi.text="获胜",core.SoundManager.getInstance().stopBgm(),core.SoundManager.getInstance().playEffect("win_m4a")):"Enemy"==t?(this.Tishi.text="失败",core.SoundManager.getInstance().stopBgm(),core.SoundManager.getInstance().playEffect("fail_m4a")):(this.Tishi.text="平局",core.SoundManager.getInstance().stopBgm()),egret.setTimeout(function(){console.log("游戏结束"),GameViewControl.getInst().LoadView(ViewList.Main),BattleConnect.getInst().end()},this,3e3))},e.prototype.AddPower=function(t){"Me"==t?this.MyPower.text=String(Number(this.MyPower.text)+Config.everyTurnPower):this.EnemyPower.text=String(Number(this.EnemyPower.text)+Config.everyTurnPower)},e.prototype.UsePower=function(t,e){return"Me"==t?Number(this.MyPower.text)>=e?(this.MyPower.text=String(Number(this.MyPower.text)-e),!0):!1:Number(this.EnemyPower.text)>=e?(this.EnemyPower.text=String(Number(this.EnemyPower.text)-e),!0):!1},e}(core.UIView);__reflect(BattleView.prototype,"BattleView");var BattleViewControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){this.view&&(this.view.parent.removeChild(this.view),this.view.destroy(),this.view=null),t.prototype.destroy.call(this)},e.prototype.open=function(t){BattleConnect.getInst().bindBattleView(this),null==this.view&&(this.view=new BattleView),this.getParent().addChild(this.view),this.view.open()},e.prototype.update=function(){},e.prototype.StartGame=function(t){GameInfo.getInst().selfUserId==t?this.view.StartGame("Me"):GameInfo.getInst().rivalUserId==t?this.view.StartGame("Enemy"):console.error("无效UserId")},e.prototype.EnemyNextTurn=function(){this.view.EnemyNextTurn()},e.prototype.Enemysummon=function(t,e){this.view.Enemysummon(t,e)},e.prototype.Result=function(t){t==GameInfo.getInst().selfUserId?this.view.Result("Me"):t==GameInfo.getInst().rivalUserId?this.view.Result("Enemy"):""==t?this.view.Result(""):console.error("无效UserId")},e}(core.ViewController);__reflect(BattleViewControl.prototype,"BattleViewControl");var LoginView=function(t){function e(){return t.call(this,"resource/skins/LoginSkin.exml")||this}return __extends(e,t),e.prototype.open=function(){this.addAllListener(),this.password.inputType=egret.TextFieldInputType.PASSWORD,core.SoundManager.getInstance().playBgm("BGM_TITLE_m4a")},e.prototype.destroy=function(){},e.prototype.addAllListener=function(){var t=this;this.BgGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.LoginGroup.visible=!0},this),this.denglu.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){var e={};HttpManager.getInst().init(),e.username=t.account.textDisplay.text,e.password=t.password.textDisplay.text,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/login",e,t)},this),this.zhuce.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){var e={};HttpManager.getInst().init(),e.username=t.account.textDisplay.text,e.password=t.password.textDisplay.text,e.password1=t.password.textDisplay.text,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/create",e,t)},this)},e.prototype.onPostComplete=function(t){var e=t.currentTarget;console.log("post data : ",e.response);var n=JSON.parse(e.response);this.GetResult(n)},e.prototype.GetResult=function(t){this.Mark.text=t.Mark,console.log(t.Mark,t.status),200==t.status&&"登录成功"==t.Mark&&this.LoginSuccess(t.userid)},e.prototype.LoginSuccess=function(t){Userinfo.getInst().userid=t.userid,Userinfo.getInst().userName=t.username,Userinfo.getInst().coins=t.wealth,DeckManager.getInst().setDeckbyStr(t.decklist),CardManager.getInst().setList(t.owncardlist),GameViewControl.getInst().LoadView(ViewList.Main)},e}(core.UIView);__reflect(LoginView.prototype,"LoginView");var LoginViewControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){this.view&&(this.view.parent.removeChild(this.view),this.view.destroy(),this.view=null),t.prototype.destroy.call(this)},e.prototype.open=function(t){null==this.view&&(this.view=new LoginView),this.getParent().addChild(this.view),this.view.open()},e.prototype.update=function(){},e}(core.ViewController);__reflect(LoginViewControl.prototype,"LoginViewControl");var MainMenuView=function(t){function e(){var e=t.call(this,"resource/skins/MainMenu.exml")||this;return e.timeid=0,e.timeid2=0,e}return __extends(e,t),e.prototype.open=function(){this.addAllListener(),core.SoundManager.getInstance().playBgm("BGM_Main_m4a")},e.prototype.destroy=function(){},e.prototype.addAllListener=function(){var t=this;this.NormalGame.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.tishi.text="正在寻找对手，请稍后...",t.tishiGroup.visible=!0,BattleConnect.getInst().isWaiting=!0,BattleConnect.getInst().init(),BattleConnect.getInst().bind(),BattleConnect.getInst().start(),0!=t.timeid&&egret.clearTimeout(t.timeid),t.timeid=egret.setTimeout(function(){0==BattleConnect.getInst().getisGameReady()&&1==BattleConnect.getInst().isWaiting&&(t.tishi.text="暂未找到合适的对手",BattleConnect.getInst().isWaiting=!1,BattleConnect.getInst().end(),0!=t.timeid2&&egret.clearTimeout(t.timeid2),t.timeid2=egret.setTimeout(function(){t.tishiGroup.visible=!1},t,2e3))},t,12e3)},this),this.Shop.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){GameViewControl.getInst().LoadView(ViewList.shop)},this),this.MyDeck.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){GameViewControl.getInst().LoadView(ViewList.MyDeck)},this),this.cancel.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.tishiGroup.visible=!1,BattleConnect.getInst().isWaiting=!1,BattleConnect.getInst().end(),0!=t.timeid&&egret.clearTimeout(t.timeid),0!=t.timeid2&&egret.clearTimeout(t.timeid2)},this)},e}(core.UIView);__reflect(MainMenuView.prototype,"MainMenuView");var MainMenuViewControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){this.view&&(this.view.parent.removeChild(this.view),this.view.destroy(),this.view=null),t.prototype.destroy.call(this)},e.prototype.open=function(t){null==this.view&&(this.view=new MainMenuView),this.getParent().addChild(this.view),this.view.open()},e.prototype.update=function(){},e}(core.ViewController);__reflect(MainMenuViewControl.prototype,"MainMenuViewControl");var MyDeckView=function(t){function e(){var e=t.call(this,"resource/skins/MyCard.exml")||this;return e.AllCards=[],e.DeckCards=[],e}return __extends(e,t),e.prototype.open=function(){this.Decklist=new Array(Config.MaxCardsId);for(var t=0;t<this.Decklist.length;t++)this.Decklist[t]=0;this.DeckNum=0,this.addAllListener(),this.setCardView();for(var e=DeckManager.getInst().getDeck(),n=0,i=e;n<i.length;n++){var r=i[n];this.AddDeck(r)}this.setDeckView()},e.prototype.destroy=function(){},e.prototype.addAllListener=function(){var t=this;this.back.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){GameViewControl.getInst().LoadView(ViewList.Main)},this),this.SaveDeck.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.DeckNum<20?(t.tishiGroup.visible=!0,t.tishi.text="卡组不足20张",egret.setTimeout(function(){t.tishiGroup.visible=!1},t,1e3)):(DeckManager.getInst().setDeck(t.Decklist),DeckManager.getInst().saveDeck(),t.tishiGroup.visible=!0,t.tishi.text="卡组保存成功",egret.setTimeout(function(){t.tishiGroup.visible=!1},t,1e3))},this)},e.prototype.setCardView=function(){for(var t,e=CardManager.getInst().getList(),n=0;n<Config.CardsNumber;n++)t=new ShowCard,t.init(n,e[n]),n%2!=0&&(t.y+=t.height),t.x+=Math.floor(n/2)*(t.width+50)+25,this.CardBox.addChild(t),this.AllCards.push(t),this.CardAddLisnter(t)},e.prototype.setDeckView=function(){var t,e=0;this.DeckCards=[],this.DeckBox.removeChildren();for(var n=0;n<Config.MaxCardsId;n++)for(var i=0;i<this.Decklist[n];i++)t=new eui.Label,t.CardId=n,t.size=50,t.text=Cardinfo.getInst().GetCardInfo(n).Name,t.x=25,t.y=75*e+25,e++,this.DeckCards.push(t),this.DeckAddLisnter(t),this.DeckBox.addChild(t)},e.prototype.CardAddLisnter=function(t){var e=this;t.addEventListener(egret.TouchEvent.TOUCH_END,function(){core.SoundManager.getInstance().playEffect(t.card.Card.Sound),t.num>0&&(e.AddDeck(t.CardId),e.setDeckView())},this)},e.prototype.DeckAddLisnter=function(t){var e=this;t.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.DeleteDeck(t.CardId),e.setDeckView()},this)},e.prototype.AddDeck=function(t){var e=this;if(t>=Config.CardsNumber&&console.error("CardId 错误"),!(this.DeckNum>=20)){if(this.Decklist[t]>=4)return this.tishiGroup.visible=!0,this.tishi.text="不可大于四张",void egret.setTimeout(function(){e.tishiGroup.visible=!1},this,1e3);for(var n=0,i=this.AllCards;n<i.length;n++){var r=i[n];r.CardId==t&&r.subone()}this.Decklist[t]++,this.DeckNum++}},e.prototype.DeleteDeck=function(t){if(t>=Config.CardsNumber&&console.error("CardId 错误"),!(this.Decklist[t]<=0)){this.Decklist[t]--,this.DeckNum--;for(var e=0,n=this.AllCards;e<n.length;e++){var i=n[e];i.CardId==t&&i.addone()}}},e.prototype.onPostComplete=function(t){var e=t.currentTarget;console.log("post data : ",e.response);JSON.parse(e.response)},e}(core.UIView);__reflect(MyDeckView.prototype,"MyDeckView");var ShowCard=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/ShowCardSkin.exml",e}return __extends(e,t),e.prototype.init=function(t,e){this.card.init(t),this.number.text="X"+e,this.num=e,this.CardId=t},e.prototype.addone=function(){this.num++,this.number.text="X"+this.num},e.prototype.subone=function(){this.num<=0||(this.num--,this.number.text="X"+this.num)},e}(eui.Component);__reflect(ShowCard.prototype,"ShowCard");var MyDeckViewControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){this.view&&(this.view.parent.removeChild(this.view),this.view.destroy(),this.view=null),t.prototype.destroy.call(this)},e.prototype.open=function(t){null==this.view&&(this.view=new MyDeckView),this.getParent().addChild(this.view),this.view.open()},e.prototype.update=function(){},e}(core.ViewController);__reflect(MyDeckViewControl.prototype,"MyDeckViewControl");var ShopView=function(t){function e(){return t.call(this,"resource/skins/ShopSkin.exml")||this}return __extends(e,t),e.prototype.open=function(){this.addAllListener(),this.cardList=[],this.cardList.push(this.card_1),this.cardList.push(this.card_2),this.cardList.push(this.card_3),this.cardList.push(this.card_4),this.cardList.push(this.card_5),this.Coins.text=String(Userinfo.getInst().coins)},e.prototype.destroy=function(){},e.prototype.addAllListener=function(){var t=this;this.BuyPack.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.BuyCardPack()},this),this.sure.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.CardBox.visible=!1},this),this.back.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){GameViewControl.getInst().LoadView(ViewList.Main)},this)},e.prototype.BuyCardPack=function(){var t=this;if(Number(this.Coins.text)<Config.CardPackCost)return this.tishi.visible=!0,void egret.setTimeout(function(){t.tishi.visible=!1},this,2e3);this.CardBox.visible=!0;for(var e=this.GetCardList(Config.PackCardsNum),n=0;n<Config.PackCardsNum;n++)this.cardList[n].init(e[n]);this.Coins.text=String(Number(this.Coins.text)-Config.CardPackCost),CardManager.getInst().AddCardList(e),CardManager.getInst().saveCard(),Userinfo.getInst().coins-=Config.CardPackCost;var i={};HttpManager.getInst().init(),i.userid=Userinfo.getInst().userid,i.cost=Config.CardPackCost,HttpManager.getInst().post("http://119.29.204.43/CardGame/backend/web/index.php?r=user/usecoin",i,this)},e.prototype.onPostComplete=function(t){var e=t.currentTarget;console.log("post data : ",e.response);JSON.parse(e.response)},e.prototype.GetCardList=function(t){for(var e=[],n=0;t>n;n++)e.push(Math.floor(Math.random()*Config.CardsNumber));return e},e}(core.UIView);__reflect(ShopView.prototype,"ShopView");var ShopViewControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){this.view&&(this.view.parent.removeChild(this.view),this.view.destroy(),this.view=null),t.prototype.destroy.call(this)},e.prototype.open=function(t){null==this.view&&(this.view=new ShopView),this.getParent().addChild(this.view),this.view.open()},e.prototype.update=function(){},e}(core.ViewController);__reflect(ShopViewControl.prototype,"ShopViewControl");var LoadingView=function(t){function e(){return t.call(this,"resource/skins/LoadingSkin.exml")||this}return __extends(e,t),e.prototype.loaderSkinComplete=function(){},e.prototype.setProgress=function(t,e){this.t_loading.text=Math.floor(100*t/e)+"%"},e}(core.UIView);__reflect(LoadingView.prototype,"LoadingView");var LoadingViewControl=function(t){function e(){var e=t.call(this)||this;return e.isResLoaded=!1,e}return __extends(e,t),e.prototype.destroy=function(){this.close(),this.view=null,t.prototype.destroy.call(this)},e.prototype.open=function(){null==this.view&&(this.view=new LoadingView),this.getParent().addChild(this.view);var t="game",e=["game","sound"];core.LoadingManage.getInstance().loadGroups(t,e,this.onResourceLoadComplete,this.onResourceLoadProgress,this)},e.prototype.close=function(){null!=this.view&&this.view.parent&&this.view.parent.removeChild(this.view)},e.prototype.onResourceLoadComplete=function(){this.isResLoaded=!0,GameViewControl.getInst().LoadView(ViewList.login)},e.prototype.onResourceLoadProgress=function(t,e){this.view.setProgress(t,e)},e}(core.ViewController);__reflect(LoadingViewControl.prototype,"LoadingViewControl");var GameInfo=function(){function t(){this.selfGroupId=-1,this.selfUserId="",this.selfUserName="",this.selfUserIcon="",this.rivalGroupId=-1,this.rivalUserId="",this.rivalUserName="",this.rivalUserIcon=""}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t}();__reflect(GameInfo.prototype,"GameInfo");var BattleConnect=function(){function t(){this.isGameReady=!1,this.isWaiting=!1}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t.prototype.bind=function(){var t=this,e=this;ALISDK.CatcherSDK.instance().on("CONNECT",function(t){console.log("onConnect",t);for(var e=0,n=t.playerList;e<n.length;e++){var i=n[e];i.groupId===t.userInfo.groupId?(GameInfo.getInst().selfGroupId=i.groupId,GameInfo.getInst().selfUserId=i.openId,GameInfo.getInst().selfUserName=i.nickname,GameInfo.getInst().selfUserIcon=i.avatarUrl):(GameInfo.getInst().rivalGroupId=i.groupId,GameInfo.getInst().rivalUserId=i.openId,GameInfo.getInst().rivalUserName=i.nickname,GameInfo.getInst().rivalUserIcon=i.avatarUrl)}}).on("READY",function(t){if(console.log("READY",t),e.isWaiting){var n={};n.userid=Userinfo.getInst().userid,ALISDK.CatcherSDK.instance().sendJson({"function":"CheckUser",params:n})}}).on("KICK",function(){}).on("GAMEOVER",function(t){console.log("onResult",t),e.isGameReady=!1}).on("BREAK",function(){}).on("CONTINUE",function(){}).on("ERROR",function(){}).on("MIC_CHANGE",function(){}).on("AUDIO_CHANGE",function(){}).on("MESSAGE",function(n){var i=n.data;switch(i["function"]){case"StartGame":console.log("StartGame");var r=i.param;e.isGameReady=!0,GameViewControl.getInst().LoadView(ViewList.battle),t.Control.StartGame(r.StartUserId);break;case"Enemysummon":t.Control.Enemysummon(i.param.Block_num,i.param.CardId);break;case"EnemyNextTurn":t.Control.EnemyNextTurn();break;case"Result":t.Control&&(console.log("result"),t.Control.Result(i.param.winner))}})},t.prototype.getisGameReady=function(){return this.isGameReady},t.prototype.start=function(){ALISDK.CatcherSDK.instance().start(),ALISDK.CatcherSDK.instance().updateProgress(ALISDK.CatcherSDK.ProgressState.COMPLETED)},t.prototype.end=function(){ALISDK.CatcherSDK.instance().end()},t.prototype.init=function(){var t=RES.getRes("netconfig_json");ALISDK.CatcherSDK.init({url:t.url,gameId:"1231231",gameVersion:"0.0.1"})},t.prototype.bindBattleView=function(t){this.Control=t},t}();__reflect(BattleConnect.prototype,"BattleConnect");var HttpManager=function(){function t(){this.init()}return t.getInst=function(){return null==t.inst&&(t.inst=new t),t.inst},t.prototype.init=function(){this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},t.prototype.post=function(t,e,n){this.request.open(t,egret.HttpMethod.POST);var i="";for(var r in e)i=i+"&&"+r+"="+e[r];this.request.send(i),this.request.addEventListener(egret.Event.COMPLETE,n.onPostComplete,n),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),this.request.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this)},t.prototype.onPostIOError=function(t){console.log("post error : "+t.type)},t.prototype.onPostProgress=function(t){console.log("post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},t}();__reflect(HttpManager.prototype,"HttpManager");